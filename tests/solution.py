import cython.primality as primality
import unittest


PRIME_IMAGE = 2221223222122266887779712223253222232111111111211233455555556556556666542222223334778988976996332333234699743333354323258774334711221233221222567877797222224961222321111111111122245566555566655667676531222157347788889647743322333446996333333442232587743346451222332212225778777982222239711442111111111111223455556666666665555666521211593477888889854433233333457743333334432325887323355621223322122256787778832222343225421111111111112334556566666665433334566311212634778888899644332333244444333333344223258863333422222233222221577877788322225323322211111111111123445566666665432233444665112224347788889996333323222343443333333442232698633255212222333222214778777893222233333332211111111111334566666665432122344445663122254377888889843433232234433433333345422326886323672222223332222147788778932233223323322111111111123455555555432222334343456751222443778888984443332222243333333333454223368863334322223774322231477887789422233333322221111111111234565555543322222222233456622245447788889833443322222333333333334542233688623333222249942322224778877895223332333232211111111123355555555433233211122234456413565478888898334333222224333333333345422337885233442222389423222237788788952223384133221111111111234555555554333322211233444575223565788888973343322222244332333333454223378852335511435555232222377887789687333766332441111111112344444455443332222223444555774234667888889723333222122333583233234542233788523243425676462221223678878896688332697757930111111123222233445433322223444455567753324688988897233332246323334733257345322338884233338822554532212236788778962364325979667311111111111122233455443222234445556667545347889888974333323684233332332562453222488842333384122664322222267888789636533332784323211111111122222334566532322344556556677545678888889853333322123433333354234532224888423333643426643221222678887897299322327623333111111122321122225765444445555555566676456788989897333332233324333333543345322248884223333556223333212226788888972463354333333332111111232111221257765555666665566666764566889899973333322375233564343333553222498842233322323223332123267788888994235952333333331111122121012222577665555666666666667755568898899623333234533335443543345532225987322333222233443321121577888888853346433333333321111221222222335776665555666666666567644588899996334432122333443233334455323259973323332222589722211215778878983333222333333333311112211344334456766655556666666655676424889999963333357732344534333333553232599732333323224555332112147788789844433333333333333211122224554455566666555555656666656775149889999634433477423334354343345532325987323332222222233321121477888898434333333333333333211232344445545676666665555555565666751598999996257332122234332784358655323269972324872222222333211214778888894343333333333333333212333455555456666666655555555656567625989999963773345433334434762665553232699623247722222223332212137788888943433333333345333443223334555555566654334445555555565666259899999635433476423345448964666532326996233333222223234322121377887889434333333333563335533333445555556665443333455556555656662598998996344432453233444547645665223279962235432222222333211213678888895343333333333333333442354455565564344444444555555556666625989999953543322232333444333345642233799522355332222443432211126788888953433333333333333334313655565555543344444555555555555566259899999634433234323334343443356422338995233333332226545322112267888889524433333333333333321116666666655433344455555554455555561498999996344433453233343344333564223389942233333222222343221122678888896234333333333333333111037566666555444444555554324555555656989999963444333332233444444334542223899422333333223223343221226788888962343333333333333421111057666655555554445654322455555556657999899544443333323334444443356422238994223333332332333322112257888889733333333333333333111110156666565666655554332356554555565248999995443432333233344444433553222499832233332223333333222121577888897334333333333333420111110057665555556554333445655555555652266399954444333332333444444335532224998322321222222323343221214778888973343343333343434201011110266655556553323454555555555556632371199645543333322234444443355322249983223212222222223332212147788889733433343434434341001111110476555553233445455555555555567311870485454433332222444444433553221499732231122222222234322121477888897344433433443344310111111111565665313455555555555555555574117920354444434432224444444335532204987322111122222222343221214778888884344434333322343101101101102665553455555555555555555555662069403337899634322344444443455313579963221111222222223432212137788888843443343223213431011010011102665556665555445555555555555730795012389999333223466545434542579989732110012222222234322121377888888434444431123234420111000111102565566665544455555555555556428960221466785321234665443345368688796213310022222222343221113778888885344444422233344201111011111101455565555445555554455555554599501221122333322343345432356744776952355311232223323443321126788888853444434554233442000011111111100355555555555555444555555537894011122232233233443454323683467969645443322233332234433211267888888534444447852344520011111101111101655555565444444455555554498830111122222222223334543336524356565554543333333354344332111678888886444542233333445400001011111111105655566654444444555555547886011111211111222222223333323332355444544322223333333455332116788888876863322222332235101100001111010037655555544444455555553588840111112111111222222222222232112345444321133433432234576621157888888789411222222221231000000111110012266655544444445555544447888201111121111122222222222222222310354442111256433332345544211577888887861111111221111110100000010013323765555544445555554443588860111111211222222222211111122212224543321112433334333444442114778877788501111111111002101000010013433038666655545555555554337888401111112222222222111111111111112234432111112223332222334321147788778764011111111110174011000003443221384655655555554555432688882011111222222222111111111111111111114310033212322111123333211477887786320111111111102771011002453222203934655555555545543248888601111112212222211111111111111111111123323553223321221233442113778777875300000000000003730001354222221049426556555555555433788894011111221112111100111111111111111010146668742232222333445431136787888776214433333323247501344222222210596145555555555544268789920111111101211111111111111111111111111465585222344224333344221266787652474344444445555445444322222221105983355555555555435876787101111110122111100011111111111111111114666456222342211233332112678831212421212223333334344321222222211069952455555555554477665640111111111211100000111111111111101111069787642221221012333321126686212122223223334444454322222222222110699734455555555557867745301111111111111000111111111110111001010698897521212224633444211156841222221222235554444322222222221221107999434455555555687787342001111111111010101001111011111110101015877898112211388323454111578322334333445565333322222111212111111079997244555566656888863200111111111110000001011110101110100111059788861222221344555554436763122454664565322222222112111111111110799984355555566657888621001110111110010001101111011000000000110399878611122221234346532147522213973543443222222221111111111111117999962555555666547885201111111101100000011111001000100000001102787895111122222233465433585222137324433422222111111111111111111189888954555555554269841011001011010000001111100001000000000000017768731111122223234553224752120232334333221111111111111111111111864578877765554237988301111111110000000101001110000000000000000166676211111222222355520036321103422343321111111111111111111111116645678889888864799972011011011100000111100111100000000000000001567742111111112114445210362121056322332211111111111111111111111048656678888999999997410110110101100000010010110000000000000000014565221111111112222442103621100687412221111111111111111111111110156666688888888888544101111100010000000100001000000000000000000145651111111111112245420025101336853122211101111111111111111111110356665678988777765630110110000000000010000000000000000000000001457611000111111211256522350169566112233201011111111111111111111012456666688887777667201101000010000001100000000000000000000000015665220111111111211487777637752572223453000111111111111111111111147788898778888898970001000100000000100100000000000000000000000156421211111111111121687786572004611210221100111111111111111111101588888888889899999501000000000000000000000000000000000000000002784122111111111111212787852102634221035201011111111111111111111114667788888898999992000100011000000001000000000000000000000000027621210000011111112104779611379532124541010011111111111111111111135788889999899989700101001000000101110000000000000000000000000252011000001111111112112123258776202554410100111111111111111111111357888999999999994010101010000010011100000000000000000000000004521111001011111111112111023586762244324200100111111111111111111013578889989999999810010000000000000011100000000000000000000000045232110000001111111112210353777633312111011001111111111111111111135788888899999995010100000000111111001000000000000000000000000441231100000111111111111102535884233101111010011111111111111111111357888888999888820100000100001110000000000000000000000000000004301222000000011111111212114558412212111010000010111111111111111103588888899888886000001001000101001000000000000000000000000000054001110000000011111111121126621222010111101000100011111111111111026888888998888830010100000001110000000000000000000000000000000562000000000011111111112121034012221000110110001110111111111111110368888899888876101100010000000000000000000000000000000000000004731111000001011111111111213420222320001110100011100111111111111103688888998877640101100100010000000000000000000000000000000000036401110000000001111111121046212212310011100000110001111111111111036788889888767301000010000110000000000000000000000000000000000355200100000000000001111111012222123200111100000110111111111111110367788898788871000011100000000000000000000000000000000000000004654000000000000000000111011222221223101111000000101111111111111103667888977889500110001001100000000000000000000000000000000000036553000000000000001111112222222222231111100000001011111111111111036678898678883011001100011000000000000000000000000000000000001246562000000000000010001232122222232221111000000011111111111111110265688886798610100100000000000000000000000000000000000000000012366743000000000000001243212222222222211110000000110111111001111102456888768894001011100010000000000000000000000000000000000000122466310000000000000234432122222222223210000000001111111110111111024567887789930100111000000000000000000000000000000000000000001302552000000000000134443322222222222222100000000001111111111111110144678867896000001100010000000000000000000000000000000000000012122200000000000134433333112322212233222100000000011101110011111101445787678840011010000000000000000000000000000000000000000000131000000011111133333333331023221122112221000000000010000001111111013458866888100011000000100000000000000000000000000000000000001211222200000013333333333310122111100001210000000000110100001111110133587678960010100000000010000000000000000000000000000000000013799999555555432332333222200221110000011100000000001000001101111101226876789400001000000000000000000000000000000000000000000001699743335555674112222222432001211100000011000010000011000001011111112268667881001010000000000000000000000000000000000000000000049520000000000011112213798321011110000000111000100000010000011111111112676679500110000000000000000000000000000000000000000000000550000000000000111222146531110110000000000011110000000100000111111111136667784000000000000000000000000000000000000000000000000003100000000000001111122100001100000000000000101100000000010001111111111366578710000000000000000000000000000000000000000000000000120000000000000011111100011111100000000000001011000000001111111111111003656785000100000000000000000000000000000000000000000000001200000000000000010000001111000000000000001001100000000011111111111000036457830000000000000000000000000000000000000000000000001012100000000000000000011101010000000000000000010000000000111111111100000134467100000000000000000000000000000000000000000000000000132000000000000001000001000000000000000000000000000000000010111111000100144440000000000000000000000000000000000000000000000000000320000000000000000000100010000000000000002200000000000000010011000000000233200000000000000000000000000000000000000000000000000003300000000000000000010000000000000000000041000000000000001001100000100000231000000000000000000000000000000000000000000000000001123000000000000000011000010000000000000013100000000000000000000025200100000110000000000000000000000000000000000000000000000000023141100000000000000110000001000000000002310000000000000000001357661000000000000000000000000000000000000000000000000000000000000130333000000000000001100000000000000000330000000000000000013576643245200000000100000000000000000000000000000000000000000000000000102321000000000000000000000000000000132000000000000001246787655667651000000011000000000000000000000000000000000000000000000000101013000000000000000010100001000000002100011000000013689988765543210000000001111000000000000000000000000000000000000000000000000100251000000000000000011000001586200100010000012467999754331100000000000000110010000000000000000000000000000000000000000000000001101520000000000000001100010048687200123333567899763210000000000000000000000110000000000000000000000000000000000000000000000000011105400000000000000000100001666788567777889864210000000000000000000000000111000000000000000000000000000000000000000000000000003311034000000000000000000012267777767778875641000000000000000000000000122210111000000000000000000000000000000000000000000000000046120240000033333445666568889977666545777535200000000000000000000002367896000100000000000000000000000000000000000000000000000000165112400001677788899889755787665555566666531000000000000000000003578877820101100000000000000000000000000000000000000000000000001353132000007768877544200378766665676555666211100000000000000002688777785010100000000000000000000000000000000000000000000000000142142420012176666541222258866675425655555530010000000000000002588777778830101000000000000000000000000000000000000000000000000002420244101444766565346689965666521367655554001000000000000002588777777786001000000000000000000000000000000000000000000000000000024301420133236666656756986665652246766545520000000000000001588777888888820100000000000000000000000000000000000000000000000000000234124102432145555654478667665126666654564111100000000000147778877655665100000000000000000000000000000000000000000000000000000002333421123222122333336766665433565555445531111100000000003478653222211122223333210000000000000000000000000000000000000000000000241235200012110001111167666532567655544554211111100000000136741101122221223332334431000000000000000000000000000000000000000000006822341111121000000000477664457665555455532211111100000001551112222222222223323222442100000000000000000000000000000000000000000078412211232121443333325766666766665555546312111111100000045112222222223334333333333344211000000000000000000000000000000000000003776212001100119999999999766766665555555473011111100013235511223233332233444444444433334464000000000000000000000000000000000000277675232221111199999999999766666555565455720111110046543541222233333323245564555444433332365010000000000000000000000000000000005987888898888887999999999997666655566545565001111004999984112333444433333434876655554543332363222211111111001100000000000000001247988898899999999999999999986555556655556830000100599899611223344543332332246776556545544443751433333333332332222222222222112223445666544788998899999999989877666665556675000010059989983122333455543223222356642555555554437602532333233333333333333333233333333222233326888989999999999999999765555555420000015998899831223345544432233223566435676655553496012333323322222222222222223232233323333333248888889999999999999986556555433356565799889998422223454543333322245554455666555448830112233332222232222332222222233333333333332178889999999999999899756655554433799999889989984233344455433332345643324544756555895101112223322222222222222233233333333323433321488899999999999999975565555444547988888999999852233345765333234555544334467675688641012112222222222222222222222222222211257422222798889999999999998656655555558889888999999977642233366542323465443343235655778766301122111222222222223333332222122345566653223324898899999999988865656666665678999888999887557753333564332345544432233345678865652001221122222344444444444444334567766787775333316999


class TestPrimality(unittest.TestCase):
    def setUp(self):
        self.mersenne_23 = 2**11213 - 1
        self.mersenne_19 = 2**4253 - 1

    def test_isprime(self):
        self.assertEqual(self.verify(self.mersenne_23, 3), 1)
        self.assertEqual(self.verify(self.mersenne_19, 3), 1)

    @unittest.skip("this image was verified before")
    def is_image_prime(self):
        self.assertEqual(self.verify(PRIME_IMAGE, 100), 1)

    @staticmethod
    def verify(prime, n):
        res = primality.is_prime(prime, n)

        print(prime)
        if res == 1:
            print("it is probably a prime")
        elif res == 2:
            print("it is prime")
        else:
            print("not prime")

        return res


if __name__ == "__main__":
    unittest.main()
